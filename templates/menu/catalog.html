{% extends "base.html" %}
{% load static %}

{% block title %}Order Menu - Brews &amp; Chews{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
{% endblock %}

{% block main_class %}dashboard-main{% endblock %}

{% block content %}

<!-- Hero section with welcome message -->
<section class="dashboard-hero">
    <div>
        <p class="dashboard-eyebrow">Welcome back, {{ request.user.profile.display_name|default:request.user.username }}</p>
        <h1 class="dashboard-title">Order Your Favorites</h1>
        <p class="dashboard-subtitle">Browse our menu and add your favorite items to your cart. Ready to order? Just click "Add to Cart"!</p>
    </div>
    <a href="{% url 'orders:cart' %}" class="btn dashboard-cta">View Cart</a>
</section>

<!-- Empty state if no categories -->
{% if not categories %}
<p class="menu-order-empty">Our menu is being finalized. Please check back soon.</p>
{% endif %}

<!-- Loop through each category -->
{% for category in categories %}
<section class="dashboard-section" aria-labelledby="category-{{ category.slug }}">
    
    <!-- Category header -->
    <header class="dashboard-section__header">
        <h2 id="category-{{ category.slug }}">{{ category.name }}</h2>
        {% if category.description %}
        <p class="dashboard-section__description">{{ category.description }}</p>
        {% endif %}
    </header>
    
    <!-- Menu items grid -->
    <div class="menu-order-grid">
        
        <!-- Loop through items in category -->
        {% for item in category.items.all %}
        <article class="menu-order-card">
            
            <!-- Item image -->
            <img src="{% static item.image|default:'img/bg.jpg' %}" 
                 alt="{{ item.name }} - {{ item.category.name }}" 
                 class="menu-order-card__image" 
                 loading="lazy">
            
            <!-- Item details -->
            <div class="menu-order-card__content">
                <h3 class="menu-order-card__title">{{ item.name }}</h3>
                <p class="menu-order-card__description">{{ item.description }}</p>
                
                <!-- Price and add button -->
                <div class="menu-order-card__footer">
                    <span class="menu-order-card__price">â‚±{{ item.base_price|floatformat:2 }}</span>
                    <form method="post" action="{% url 'orders:add_to_cart' %}" style="display: inline;">
                        {% csrf_token %}
                        <input type="hidden" name="menu_item_id" value="{{ item.id }}">
                        <input type="hidden" name="quantity" value="1">
                        <button type="submit" class="btn btn-small">Add to Cart</button>
                    </form>
                </div>
            </div>
        </article>
        
        <!-- Empty state if no items -->
        {% empty %}
        <p class="menu-order-empty">No items are currently available in this category.</p>
        {% endfor %}
    </div>
</section>
{% endfor %}

{% endblock %}