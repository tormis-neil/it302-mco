{% extends "base.html" %}
{% load static %}

{% block title %}Checkout - Brews &amp; Chews{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
{% endblock %}

{% block main_class %}dashboard-main{% endblock %}

{% block content %}

<!-- Hero section -->
<section class="dashboard-hero">
    <div>
        <p class="dashboard-eyebrow">Secure Checkout</p>
        <h1 class="dashboard-title">Confirm your order</h1>
        <p class="dashboard-subtitle">Review your order details and provide contact information to complete your purchase.</p>
    </div>
    <a href="{% url 'orders:cart' %}" class="btn dashboard-cta">Back to cart</a>
</section>

<!-- Two-column checkout layout -->
<section class="dashboard-section checkout-layout" aria-labelledby="checkout-details">
    
    <!-- Left column: Contact form -->
    <div class="checkout-form-wrapper">
        <h2 id="checkout-details" class="dashboard-section__title">Contact information</h2>

        <form class="profile-form" method="post" action="{% url 'orders:checkout' %}">
            {% csrf_token %}

            <div class="profile-form__field">
                <label for="contact_name">Full name *</label>
                <input id="contact_name" name="contact_name" type="text" value="{{ contact_info.name }}" required minlength="2" maxlength="120">
            </div>

            <div class="profile-form__field">
                <label for="contact_phone">
                    Phone number *
                </label>
                <input id="contact_phone" name="contact_phone" type="tel" value="{{ contact_info.phone }}" required maxlength="20">
            </div>

            <div class="profile-form__field">
                <label for="special_instructions">Special instructions</label>
                <textarea id="special_instructions" name="special_instructions" rows="3" maxlength="500">{{ contact_info.instructions }}</textarea>
            </div>

            <button type="submit" class="btn profile-form__submit">Place Order</button>
        </form>
    </div>
    
    <!-- Right column: Order summary -->
    <aside class="checkout-summary" aria-labelledby="checkout-summary">
        <h2 id="checkout-summary" class="dashboard-section__title">Order summary</h2>
        
        <!-- Items list -->
        <ul class="checkout-items">
            {% for item in cart_items %}
            <li class="checkout-items__entry">
                <div>
                    <strong>{{ item.menu_item.name }}</strong>
                    <span class="checkout-items__meta">Qty {{ item.quantity }}</span>
                </div>
                <span>₱{{ item.line_total|floatformat:2 }}</span>
            </li>
            {% endfor %}
        </ul>
        
        <!-- Totals -->
        <dl class="cart-summary__list">
            <div class="cart-summary__row">
                <dt>Subtotal</dt>
                <dd>₱{{ subtotal|floatformat:2 }}</dd>
            </div>
            <div class="cart-summary__row">
                <dt>Tax (8%)</dt>
                <dd>₱{{ tax|floatformat:2 }}</dd>
            </div>
            <div class="cart-summary__row cart-summary__total">
                <dt>Total</dt>
                <dd>₱{{ total|floatformat:2 }}</dd>
            </div>
        </dl>
    </aside>
</section>

{% endblock %}