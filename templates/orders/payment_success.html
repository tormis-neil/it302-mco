{% extends "base.html" %}
{% load static %}

{% block title %}Payment Successful - Brews &amp; Chews{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
{% endblock %}

{% block main_class %}dashboard-main{% endblock %}

{% block content %}

<!-- Hero section -->
<section class="dashboard-hero">
    <div>
        <p class="dashboard-eyebrow">Payment Complete</p>
        <h1 class="dashboard-title">Thank you for your order!</h1>
        <p class="dashboard-subtitle">Your payment has been processed and your order is being prepared.</p>
    </div>
    <a href="{% url 'menu:catalog' %}" class="btn dashboard-cta">Back to Menu</a>
</section>

<!-- Order confirmation card -->
<section class="dashboard-section" aria-labelledby="order-confirmation">
    <h2 id="order-confirmation" class="dashboard-section__title">Order Details</h2>

    <div class="history-card">
        <!-- Order header with status -->
        <header class="history-card__header">
            <div class="history-card__header-info">
                <h3 class="history-card__title">Order {{ order.reference_number }}</h3>
                <p class="history-card__meta">
                    Placed on {{ order.created_at|date:"M d, Y g:i a" }}
                </p>
            </div>
            <span class="history-card__status history-card__status--{{ order.status }}">
                {{ order.get_status_display }}
            </span>
        </header>

        <!-- Order items list -->
        <ul class="history-card__items">
            {% for item in order.items.all %}
            <li>
                <strong>{{ item.menu_item_name }}</strong>
                <span class="history-card__items-meta">Qty {{ item.quantity }}</span>
                <span>&#8369;{{ item.line_total|floatformat:2 }}</span>
            </li>
            {% endfor %}
        </ul>

        <!-- Order footer with totals and contact info -->
        <footer class="history-card__footer">
            <dl>
                <div>
                    <dt>Contact Name</dt>
                    <dd>{{ order.contact_name }}</dd>
                </div>
                {% if order.contact_phone %}
                <div>
                    <dt>Phone</dt>
                    <dd>{{ order.contact_phone }}</dd>
                </div>
                {% endif %}
                <div>
                    <dt>Subtotal</dt>
                    <dd>&#8369;{{ order.subtotal|floatformat:2 }}</dd>
                </div>
                <div>
                    <dt>Tax (8%)</dt>
                    <dd>&#8369;{{ order.tax|floatformat:2 }}</dd>
                </div>
                <div class="history-card__total">
                    <dt>Total</dt>
                    <dd>&#8369;{{ order.total|floatformat:2 }}</dd>
                </div>
            </dl>

            {% if order.special_instructions %}
            <dl class="history-card__notes">
                <dt>Special Instructions</dt>
                <dd>{{ order.special_instructions }}</dd>
            </dl>
            {% endif %}
        </footer>
    </div>
</section>

<!-- What happens next info -->
<section class="dashboard-section" aria-labelledby="next-steps">
    <h2 id="next-steps" class="dashboard-section__title">What happens next?</h2>

    <div class="history-card">
        <ol class="next-steps-list">
            {% if payment_confirmed %}
            <li>Your payment has been confirmed!</li>
            <li>Our team is now preparing your order</li>
            {% else %}
            <li>Your payment is being verified</li>
            <li>Once confirmed, our team will prepare your order</li>
            {% endif %}
            <li>You'll see the status update in your order history</li>
            <li>Pick up your order when it's ready!</li>
        </ol>
    </div>
</section>

<!-- Action buttons -->
<div class="payment-actions">
    <a href="{% url 'menu:catalog' %}" class="btn btn-secondary">Back to Menu</a>
    <a href="{% url 'orders:history' %}" class="btn">View Order History</a>
</div>

{% endblock %}
